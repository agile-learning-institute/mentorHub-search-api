version: "1.1"
name: Search API Check
env:
  host: localhost:8081
tests:
  observable:
    name: Test Observability
    steps:
      - name: GET Config Values
        http:
          url: http://${{env.host}}/api/config/
          method: GET
          check:
            status: /200/
            schema:
              type: object
              properties:
                configItems:
                  type: array
                apiVersion:
                  type: string
              required:
                - configItems
                - apiVersion
              additionalProperties: false
      - name: GET Health
        http:
          url: http://${{env.host}}/api/health/
          method: GET
          check:
            status: /200/
  search:
    name: Test /api/search endpoint
    steps:
      - name: GET a list of cards
        http:
          url: http://${{env.host}}/api/search/
          method: GET
          check:
            status: /200/
            schema:
              type: array
              items:
                type: object
                properties:
                  _id:
                    type: string
                  collection:
                    type: string
                  collection_id:
                    type: string
                  document:
                    type: object
                required:
                  - _id
                  - collection
                  - collection_id
                  - document
                additionalProperties: false
